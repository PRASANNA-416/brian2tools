

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Plotting tools &mdash; brian2tools  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="NeuroML exporter" href="exporter_user.html" />
    <link rel="prev" title="Installation instructions" href="installation.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> brian2tools
          

          
          </a>

          
            
            
              <div class="version">
                0.2.1.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../release_notes.html">Release notes</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">User’s guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="installation.html">Installation instructions</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Plotting tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="exporter_user.html">NeuroML exporter</a></li>
<li class="toctree-l2"><a class="reference internal" href="nmlimport.html">NeuroML importer</a></li>
<li class="toctree-l2"><a class="reference internal" href="baseexporter_user.html">Base exporter</a></li>
<li class="toctree-l2"><a class="reference internal" href="mdexporter_user.html">Markdown exporter</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../developer/index.html">Developer’s guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../reference/brian2tools.html">brian2tools package</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">brian2tools</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">User’s guide</a> &raquo;</li>
        
      <li>Plotting tools</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/user/plotting.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="plotting-tools">
<h1>Plotting tools<a class="headerlink" href="#plotting-tools" title="Permalink to this headline">¶</a></h1>
<p>The <a class="reference internal" href="../reference/brian2tools.html#module-brian2tools" title="brian2tools"><code class="xref py py-obj docutils literal notranslate"><span class="pre">brian2tools</span></code></a> package offers plotting tools for some standard plots of various <code class="xref py py-obj docutils literal notranslate"><span class="pre">brian2</span></code> objects. It provides two
approaches to produce plots:</p>
<ol class="arabic simple">
<li><p>a convenience method <a class="reference internal" href="../reference/brian2tools.plotting.base.html#brian2tools.plotting.base.brian_plot" title="brian2tools.plotting.base.brian_plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">brian_plot</span></code></a> that takes an object such as a
<a class="reference external" href="https://brian2.readthedocs.io/en/stable/reference/brian2.monitors.spikemonitor.SpikeMonitor.html#brian2.monitors.spikemonitor.SpikeMonitor" title="(in Brian 2 v2.4)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SpikeMonitor</span></code></a> and produces a useful plot out of it (in this case, a raster plot). This
method is rather meant for quick investigation than for creating publication-ready plots. The details of these plots
might change in future versions, so do not rely in this function if you expect your plots to stay the same.</p></li>
<li><p>specific methods such as <a class="reference internal" href="../reference/brian2tools.plotting.data.html#brian2tools.plotting.data.plot_raster" title="brian2tools.plotting.data.plot_raster"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_raster</span></code></a> or
<a class="reference internal" href="../reference/brian2tools.plotting.morphology.html#brian2tools.plotting.morphology.plot_morphology" title="brian2tools.plotting.morphology.plot_morphology"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_morphology</span></code></a>, that allow for more detailed settings of plot parameters.</p></li>
</ol>
<p>In both cases, the plotting functions will return a reference to the matplotlib <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.3.2)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Axes</span></code></a> object, allowing
to further tweak the code (e.g. setting a title, changing the labels, etc.). The functions will automatically take care
of labelling the plot with the names of the plotted variables and their units (for this to work, the “unprocessed”
objects have to be used: e.g. plotting <code class="docutils literal notranslate"><span class="pre">neurons.v</span></code> can automatically state the name <code class="docutils literal notranslate"><span class="pre">v</span></code> and the unit of <code class="docutils literal notranslate"><span class="pre">v</span></code>,
whereas <code class="docutils literal notranslate"><span class="pre">neurons.v[:]</span></code> can only state its unit and <code class="docutils literal notranslate"><span class="pre">np.array(neurons.v)</span></code> will state neither name nor unit).</p>
<div class="contents local topic" id="overview">
<p class="topic-title">Overview</p>
<ul class="simple">
<li><p><a class="reference internal" href="#plotting-recorded-activity" id="id3">Plotting recorded activity</a></p>
<ul>
<li><p><a class="reference internal" href="#spikes" id="id4">Spikes</a></p></li>
<li><p><a class="reference internal" href="#rates" id="id5">Rates</a></p></li>
<li><p><a class="reference internal" href="#state-variables" id="id6">State variables</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#plotting-synaptic-connections-and-variables" id="id7">Plotting synaptic connections and variables</a></p>
<ul>
<li><p><a class="reference internal" href="#connections" id="id8">Connections</a></p></li>
<li><p><a class="reference internal" href="#synaptic-variables-weights-delays-etc" id="id9">Synaptic variables (weights, delays, etc.)</a></p></li>
<li><p><a class="reference internal" href="#multiple-synapses-per-source-target-pair" id="id10">Multiple synapses per source-target pair</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#plotting-neuronal-morphologies" id="id11">Plotting neuronal morphologies</a></p>
<ul>
<li><p><a class="reference internal" href="#dendograms" id="id12">Dendograms</a></p></li>
<li><p><a class="reference internal" href="#morphologies-in-2d-or-3d" id="id13">Morphologies in 2D or 3D</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="plotting-recorded-activity">
<h2><a class="toc-backref" href="#id3">Plotting recorded activity</a><a class="headerlink" href="#plotting-recorded-activity" title="Permalink to this headline">¶</a></h2>
<p>We’ll use the following example (the <em>CUBA example</em> from Brian 2) as a demonstration.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">brian2</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">Vt</span> <span class="o">=</span> <span class="o">-</span><span class="mi">50</span><span class="o">*</span><span class="n">mV</span>
<span class="n">Vr</span> <span class="o">=</span> <span class="o">-</span><span class="mi">60</span><span class="o">*</span><span class="n">mV</span>

<span class="n">eqs</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;dv/dt  = (ge+gi-(v + 49*mV))/(20*ms) : volt (unless refractory)</span>
<span class="s1">         dge/dt = -ge/(5*ms) : volt</span>
<span class="s1">         dgi/dt = -gi/(10*ms) : volt</span>
<span class="s1">      &#39;&#39;&#39;</span>
<span class="n">P</span> <span class="o">=</span> <span class="n">NeuronGroup</span><span class="p">(</span><span class="mi">4000</span><span class="p">,</span> <span class="n">eqs</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="s1">&#39;v&gt;Vt&#39;</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="s1">&#39;v = Vr&#39;</span><span class="p">,</span> <span class="n">refractory</span><span class="o">=</span><span class="mi">5</span><span class="o">*</span><span class="n">ms</span><span class="p">,</span>
                <span class="n">method</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>
<span class="n">P</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="s1">&#39;Vr + rand() * (Vt - Vr)&#39;</span>
<span class="n">P</span><span class="o">.</span><span class="n">ge</span> <span class="o">=</span> <span class="mi">0</span><span class="o">*</span><span class="n">mV</span>
<span class="n">P</span><span class="o">.</span><span class="n">gi</span> <span class="o">=</span> <span class="mi">0</span><span class="o">*</span><span class="n">mV</span>

<span class="n">we</span> <span class="o">=</span> <span class="p">(</span><span class="mi">60</span><span class="o">*</span><span class="mf">0.27</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span><span class="o">*</span><span class="n">mV</span> <span class="c1"># excitatory synaptic weight (voltage)</span>
<span class="n">wi</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="o">*</span><span class="mf">4.5</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span><span class="o">*</span><span class="n">mV</span> <span class="c1"># inhibitory synaptic weight</span>
<span class="n">Ce</span> <span class="o">=</span> <span class="n">Synapses</span><span class="p">(</span><span class="n">P</span><span class="p">[:</span><span class="mi">3200</span><span class="p">],</span> <span class="n">P</span><span class="p">,</span> <span class="n">on_pre</span><span class="o">=</span><span class="s1">&#39;ge += we&#39;</span><span class="p">)</span>
<span class="n">Ci</span> <span class="o">=</span> <span class="n">Synapses</span><span class="p">(</span><span class="n">P</span><span class="p">[</span><span class="mi">3200</span><span class="p">:],</span> <span class="n">P</span><span class="p">,</span> <span class="n">on_pre</span><span class="o">=</span><span class="s1">&#39;gi += wi&#39;</span><span class="p">)</span>
<span class="n">Ce</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.02</span><span class="p">)</span>
<span class="n">Ci</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.02</span><span class="p">)</span>

<span class="n">spike_mon</span> <span class="o">=</span> <span class="n">SpikeMonitor</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="n">rate_mon</span> <span class="o">=</span> <span class="n">PopulationRateMonitor</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="n">state_mon</span> <span class="o">=</span> <span class="n">StateMonitor</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="n">record</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">])</span>  <span class="c1"># record three cells</span>

<span class="n">run</span><span class="p">(</span><span class="mi">1</span> <span class="o">*</span> <span class="n">second</span><span class="p">)</span>
</pre></div>
</div>
<p>We will also assume that <code class="docutils literal notranslate"><span class="pre">brian2tools</span></code> has been imported like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">brian2tools</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
<div class="section" id="spikes">
<h3><a class="toc-backref" href="#id4">Spikes</a><a class="headerlink" href="#spikes" title="Permalink to this headline">¶</a></h3>
<p>To plot a basic raster plot, you can call <a class="reference internal" href="../reference/brian2tools.plotting.base.html#brian2tools.plotting.base.brian_plot" title="brian2tools.plotting.base.brian_plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">brian_plot</span></code></a> with the
<a class="reference external" href="https://brian2.readthedocs.io/en/stable/reference/brian2.monitors.spikemonitor.SpikeMonitor.html#brian2.monitors.spikemonitor.SpikeMonitor" title="(in Brian 2 v2.4)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SpikeMonitor</span></code></a> as its argument:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brian_plot</span><span class="p">(</span><span class="n">spike_mon</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/brian_plot_spike_mon.png" src="../_images/brian_plot_spike_mon.png" />
<p>To have more control over the plot, or to plot spikes that are not stored in a
<a class="reference external" href="https://brian2.readthedocs.io/en/stable/reference/brian2.monitors.spikemonitor.SpikeMonitor.html#brian2.monitors.spikemonitor.SpikeMonitor" title="(in Brian 2 v2.4)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SpikeMonitor</span></code></a>, use <a class="reference internal" href="../reference/brian2tools.plotting.data.html#brian2tools.plotting.data.plot_raster" title="brian2tools.plotting.data.plot_raster"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_raster</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plot_raster</span><span class="p">(</span><span class="n">spike_mon</span><span class="o">.</span><span class="n">i</span><span class="p">,</span> <span class="n">spike_mon</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">time_unit</span><span class="o">=</span><span class="n">second</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/plot_raster.png" src="../_images/plot_raster.png" />
</div>
<div class="section" id="rates">
<h3><a class="toc-backref" href="#id5">Rates</a><a class="headerlink" href="#rates" title="Permalink to this headline">¶</a></h3>
<p>Calling <a class="reference internal" href="../reference/brian2tools.plotting.base.html#brian2tools.plotting.base.brian_plot" title="brian2tools.plotting.base.brian_plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">brian_plot</span></code></a> with the <a class="reference external" href="https://brian2.readthedocs.io/en/stable/reference/brian2.monitors.ratemonitor.PopulationRateMonitor.html#brian2.monitors.ratemonitor.PopulationRateMonitor" title="(in Brian 2 v2.4)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">PopulationRateMonitor</span></code></a> will plot
the rate smoothed with a Gaussian window with 1ms standard deviation.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brian_plot</span><span class="p">(</span><span class="n">rate_mon</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/brian_plot_rate_mon.svg" src="../_images/brian_plot_rate_mon.svg" /><p>To plot the rate with a different smoothing and/or to set other details of the plot use
<a class="reference internal" href="../reference/brian2tools.plotting.data.html#brian2tools.plotting.data.plot_raster" title="brian2tools.plotting.data.plot_raster"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_raster</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plot_rate</span><span class="p">(</span><span class="n">rate_mon</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">rate_mon</span><span class="o">.</span><span class="n">smooth_rate</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="s1">&#39;flat&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">10.1</span><span class="o">*</span><span class="n">ms</span><span class="p">),</span>
          <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/plot_rate.svg" src="../_images/plot_rate.svg" /></div>
<div class="section" id="state-variables">
<h3><a class="toc-backref" href="#id6">State variables</a><a class="headerlink" href="#state-variables" title="Permalink to this headline">¶</a></h3>
<p>Finally, calling <a class="reference internal" href="../reference/brian2tools.plotting.base.html#brian2tools.plotting.base.brian_plot" title="brian2tools.plotting.base.brian_plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">brian_plot</span></code></a> with the <a class="reference external" href="https://brian2.readthedocs.io/en/stable/reference/brian2.monitors.statemonitor.StateMonitor.html#brian2.monitors.statemonitor.StateMonitor" title="(in Brian 2 v2.4)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">StateMonitor</span></code></a> will plot
the recorded voltage traces:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brian_plot</span><span class="p">(</span><span class="n">state_mon</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/brian_plot_state_mon.svg" src="../_images/brian_plot_state_mon.svg" /><p>By indexing the <a class="reference external" href="https://brian2.readthedocs.io/en/stable/reference/brian2.monitors.statemonitor.StateMonitor.html#brian2.monitors.statemonitor.StateMonitor" title="(in Brian 2 v2.4)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">StateMonitor</span></code></a>, the plot can be restricted to a subset of the recorded
neurons:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brian_plot</span><span class="p">(</span><span class="n">state_mon</span><span class="p">[</span><span class="mi">1000</span><span class="p">])</span>
</pre></div>
</div>
<img alt="../_images/brian_plot_state_mon_view.svg" src="../_images/brian_plot_state_mon_view.svg" /><p>Again, for more detailed control you can directly use the <a class="reference internal" href="../reference/brian2tools.plotting.data.html#brian2tools.plotting.data.plot_state" title="brian2tools.plotting.data.plot_state"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_state</span></code></a> function. Here we also
demonstrate the use of the returned <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.3.2)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Axes</span></code></a> object to add a legend to the plot:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">plot_state</span><span class="p">(</span><span class="n">state_mon</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">state_mon</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;membrane potential&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;neuron 0&#39;</span><span class="p">,</span> <span class="s1">&#39;neuron 100&#39;</span><span class="p">,</span> <span class="s1">&#39;neuron 1000&#39;</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/plot_state.svg" src="../_images/plot_state.svg" /></div>
</div>
<div class="section" id="plotting-synaptic-connections-and-variables">
<h2><a class="toc-backref" href="#id7">Plotting synaptic connections and variables</a><a class="headerlink" href="#plotting-synaptic-connections-and-variables" title="Permalink to this headline">¶</a></h2>
<p>For the following examples, we create synapses and synaptic weights according to “distances” (differences between the
source and target indices):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">brian2</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">group</span> <span class="o">=</span> <span class="n">NeuronGroup</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;dv/dt = -v / (10*ms) : volt&#39;</span><span class="p">,</span>
                    <span class="n">threshold</span><span class="o">=</span><span class="s1">&#39;v &gt; -50*mV&#39;</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="s1">&#39;v = -60*mV&#39;</span><span class="p">)</span>

<span class="n">synapses</span> <span class="o">=</span> <span class="n">Synapses</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="n">group</span><span class="p">,</span> <span class="s1">&#39;w : volt&#39;</span><span class="p">,</span> <span class="n">on_pre</span><span class="o">=</span><span class="s1">&#39;v += w&#39;</span><span class="p">)</span>

<span class="c1"># Connect to cells with indices no more than +/- 10 from the source index with</span>
<span class="c1"># a probability of 50% (but do not create self-connections)</span>
<span class="n">synapses</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="s1">&#39;i+k for k in sample(-10, 10, p=0.5) if k != 0&#39;</span><span class="p">,</span>
                 <span class="n">skip_if_invalid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># ignore values outside of the limits</span>
<span class="c1"># Set synaptic weights depending on the distance (in terms of indices) between</span>
<span class="c1"># the source and target cell and add some randomness</span>
<span class="n">synapses</span><span class="o">.</span><span class="n">w</span> <span class="o">=</span> <span class="s1">&#39;(exp(-(i - j)**2/10.) + 0.5 * rand())*mV&#39;</span>
<span class="c1"># Set synaptic weights randomly</span>
<span class="n">synapses</span><span class="o">.</span><span class="n">delay</span> <span class="o">=</span> <span class="s1">&#39;1*ms + 2*ms*rand()&#39;</span>
</pre></div>
</div>
<div class="section" id="connections">
<h3><a class="toc-backref" href="#id8">Connections</a><a class="headerlink" href="#connections" title="Permalink to this headline">¶</a></h3>
<p>A call of <a class="reference internal" href="../reference/brian2tools.plotting.base.html#brian2tools.plotting.base.brian_plot" title="brian2tools.plotting.base.brian_plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">brian_plot</span></code></a> with a <a class="reference external" href="https://brian2.readthedocs.io/en/stable/reference/brian2.synapses.synapses.Synapses.html#brian2.synapses.synapses.Synapses" title="(in Brian 2 v2.4)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Synapses</span></code></a> object will plot all
connections, plotting either the matrix as an image, the connections as a scatter plot, or a 2-dimensional histogram
(using matplotlib’s <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.axes.Axes.hexbin.html#matplotlib.axes.Axes.hexbin" title="(in Matplotlib v3.3.2)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">hexbin</span></code></a> function). The decision which type of plot to use is based on some
heuristics applied to the number of synapses and might possibly change in future versions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brian_plot</span><span class="p">(</span><span class="n">synapses</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/brian_plot_synapses.png" src="../_images/brian_plot_synapses.png" />
<p>As explained above, for a large connection matrix this would instead use an approach based on a hexagonal 2D histogram:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">big_group</span> <span class="o">=</span> <span class="n">NeuronGroup</span><span class="p">(</span><span class="mi">10000</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">many_synapses</span> <span class="o">=</span> <span class="n">Synapses</span><span class="p">(</span><span class="n">big_group</span><span class="p">,</span> <span class="n">big_group</span><span class="p">)</span>
<span class="n">many_synapses</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="s1">&#39;i+k for k in range(-2000, 2000) if rand() &lt; exp(-(k/1000.)**2)&#39;</span><span class="p">,</span>
                      <span class="n">skip_if_invalid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">brian_plot</span><span class="p">(</span><span class="n">many_synapses</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/brian_plot_synapses_big.png" src="../_images/brian_plot_synapses_big.png" />
<p>Under the hood <a class="reference internal" href="../reference/brian2tools.plotting.base.html#brian2tools.plotting.base.brian_plot" title="brian2tools.plotting.base.brian_plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">brian_plot</span></code></a> calls <a class="reference internal" href="../reference/brian2tools.plotting.synapses.html#brian2tools.plotting.synapses.plot_synapses" title="brian2tools.plotting.synapses.plot_synapses"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_synapses</span></code></a> which can
also be used directly for more control:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plot_synapses</span><span class="p">(</span><span class="n">synapses</span><span class="o">.</span><span class="n">i</span><span class="p">,</span> <span class="n">synapses</span><span class="o">.</span><span class="n">j</span><span class="p">,</span> <span class="n">plot_type</span><span class="o">=</span><span class="s1">&#39;scatter&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/plot_synapses_connections.svg" src="../_images/plot_synapses_connections.svg" /></div>
<div class="section" id="synaptic-variables-weights-delays-etc">
<h3><a class="toc-backref" href="#id9">Synaptic variables (weights, delays, etc.)</a><a class="headerlink" href="#synaptic-variables-weights-delays-etc" title="Permalink to this headline">¶</a></h3>
<p>Synaptic variables such as synaptic weights or delays can also be plotted with <a class="reference internal" href="../reference/brian2tools.plotting.base.html#brian2tools.plotting.base.brian_plot" title="brian2tools.plotting.base.brian_plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">brian_plot</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">brian_plot</span><span class="p">(</span><span class="n">synapses</span><span class="o">.</span><span class="n">w</span><span class="p">)</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">brian_plot</span><span class="p">(</span><span class="n">synapses</span><span class="o">.</span><span class="n">delay</span><span class="p">)</span>
<span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/plot_synapses_weights_delays.svg" src="../_images/plot_synapses_weights_delays.svg" /><p>Again, using <a class="reference internal" href="../reference/brian2tools.plotting.synapses.html#brian2tools.plotting.synapses.plot_synapses" title="brian2tools.plotting.synapses.plot_synapses"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_synapses</span></code></a> provides more control. The following code snippet also calls
the <a class="reference internal" href="../reference/brian2tools.plotting.base.html#brian2tools.plotting.base.add_background_pattern" title="brian2tools.plotting.base.add_background_pattern"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_background_pattern</span></code></a> function to make the distinction between white color values and
the background clearer:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">plot_synapses</span><span class="p">(</span><span class="n">synapses</span><span class="o">.</span><span class="n">i</span><span class="p">,</span> <span class="n">synapses</span><span class="o">.</span><span class="n">j</span><span class="p">,</span> <span class="n">synapses</span><span class="o">.</span><span class="n">w</span><span class="p">,</span> <span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;synaptic weights&#39;</span><span class="p">,</span>
                   <span class="n">plot_type</span><span class="o">=</span><span class="s1">&#39;scatter&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;hot&#39;</span><span class="p">)</span>
<span class="n">add_background_pattern</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Recurrent connections&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/plot_synapses_weights_custom.png" src="../_images/plot_synapses_weights_custom.png" />
</div>
<div class="section" id="multiple-synapses-per-source-target-pair">
<h3><a class="toc-backref" href="#id10">Multiple synapses per source-target pair</a><a class="headerlink" href="#multiple-synapses-per-source-target-pair" title="Permalink to this headline">¶</a></h3>
<p>In Brian, source-target pairs can be connected by more than a single synapse. In this case you cannot plot synaptic
state variables (because it is ill-defined what to plot) but you can still plot connections which will show how many
synapses exists. For example, if we make the same <a class="reference external" href="https://brian2.readthedocs.io/en/stable/reference/brian2.synapses.synapses.Synapses.html#brian2.synapses.synapses.Synapses.connect" title="(in Brian 2 v2.4)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">connect</span></code></a> from above a second time,
the new synapses will be added to the existing ones so some source-target pairs are now connected by two synapses:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">synapses</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="s1">&#39;i+k for k in sample(-10, 10, p=0.5) if k != 0&#39;</span><span class="p">,</span>
                 <span class="n">skip_if_invalid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Calling <a class="reference internal" href="../reference/brian2tools.plotting.base.html#brian2tools.plotting.base.brian_plot" title="brian2tools.plotting.base.brian_plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">brian_plot</span></code></a> or <a class="reference internal" href="../reference/brian2tools.plotting.synapses.html#brian2tools.plotting.synapses.plot_synapses" title="brian2tools.plotting.synapses.plot_synapses"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_synapses</span></code></a> will now show the
number of synapses between each pair of neurons:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brian_plot</span><span class="p">(</span><span class="n">synapses</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/brian_plot_multiple_synapses.png" src="../_images/brian_plot_multiple_synapses.png" />
</div>
</div>
<div class="section" id="plotting-neuronal-morphologies">
<h2><a class="toc-backref" href="#id11">Plotting neuronal morphologies</a><a class="headerlink" href="#plotting-neuronal-morphologies" title="Permalink to this headline">¶</a></h2>
<p>In the following, we’ll use a reconstruction from the Destexhe lab (a neocortical pyramidal neuron from the cat
brain <a class="footnote-reference brackets" href="#id2" id="id1">1</a>) that we load into Brian:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">brian2</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">morpho</span> <span class="o">=</span> <span class="n">Morphology</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s1">&#39;51-2a.CNG.swc&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="dendograms">
<h3><a class="toc-backref" href="#id12">Dendograms</a><a class="headerlink" href="#dendograms" title="Permalink to this headline">¶</a></h3>
<p>Calling <a class="reference internal" href="../reference/brian2tools.plotting.base.html#brian2tools.plotting.base.brian_plot" title="brian2tools.plotting.base.brian_plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">brian_plot</span></code></a> with a <a class="reference external" href="https://brian2.readthedocs.io/en/stable/reference/brian2.spatialneuron.morphology.Morphology.html#brian2.spatialneuron.morphology.Morphology" title="(in Brian 2 v2.4)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Morphology</span></code></a> will plot a
dendogram:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brian_plot</span><span class="p">(</span><span class="n">morpho</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/plot_dendrogram.svg" src="../_images/plot_dendrogram.svg" /><p>The <a class="reference internal" href="../reference/brian2tools.plotting.morphology.html#brian2tools.plotting.morphology.plot_dendrogram" title="brian2tools.plotting.morphology.plot_dendrogram"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_dendrogram</span></code></a> function does the same thing, but in contrast to the other
plot functions it does not allow any customization at the moment, so there is no benefit over using
<a class="reference internal" href="../reference/brian2tools.plotting.base.html#brian2tools.plotting.base.brian_plot" title="brian2tools.plotting.base.brian_plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">brian_plot</span></code></a>.</p>
</div>
<div class="section" id="morphologies-in-2d-or-3d">
<span id="plotting-morphologies"></span><h3><a class="toc-backref" href="#id13">Morphologies in 2D or 3D</a><a class="headerlink" href="#morphologies-in-2d-or-3d" title="Permalink to this headline">¶</a></h3>
<p>In addition to the dendogram which only plots the general structure but not the actual morphology of the neuron in
space, you can plot the morphology using <a class="reference internal" href="../reference/brian2tools.plotting.morphology.html#brian2tools.plotting.morphology.plot_morphology" title="brian2tools.plotting.morphology.plot_morphology"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_morphology</span></code></a>. For a 3D morphology, this
will plot the morphology in 3D using the <a class="reference external" href="http://docs.enthought.com/mayavi/mayavi/">Mayavi package</a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plot_morphology</span><span class="p">(</span><span class="n">morpho</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/plot_morphology_3d.png" src="../_images/plot_morphology_3d.png" />
<p>For artificially created morphologies (where one might only use coordinates in 2D) or to get a quick view of a
morphology, you can also plot it in 2D (this will be done automatically if the coordinates are 2D only):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plot_morphology</span><span class="p">(</span><span class="n">morpho</span><span class="p">,</span> <span class="n">plot_3d</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/plot_morphology_2d.svg" src="../_images/plot_morphology_2d.svg" /><p>Both 2D and 3D morphology plots can be further customized, e.g. they can show the width of the compartments and do not
use the default alternation between blue and red for each section:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plot_morphology</span><span class="p">(</span><span class="n">morpho</span><span class="p">,</span> <span class="n">plot_3d</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">show_compartments</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">show_diameter</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;darkblue&#39;</span><span class="p">,))</span>
</pre></div>
</div>
<img alt="../_images/plot_morphology_3d_diameters.png" src="../_images/plot_morphology_3d_diameters.png" />
<dl class="footnote brackets">
<dt class="label" id="id2"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>Available at <a class="reference external" href="http://neuromorpho.org/neuron_info.jsp?neuron_name=51-2a">http://neuromorpho.org/neuron_info.jsp?neuron_name=51-2a</a></p>
</dd>
</dl>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="exporter_user.html" class="btn btn-neutral float-right" title="NeuroML exporter" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="installation.html" class="btn btn-neutral float-left" title="Installation instructions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Brian authors

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>